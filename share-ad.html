<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KUBA Miner - แชร์รูปโปรโมท</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#0f0f1a; color:#fff; font-family:'Poppins',sans-serif; text-align:center; padding:20px; }
    .container { max-width:400px; margin:auto; }
    canvas { border-radius:20px; margin:20px auto; display:block; box-shadow:0 10px 30px rgba(255,215,0,0.3); }
    .btn { 
      background:linear-gradient(45deg,#FFD700,#FFA500); color:#000; border:none; padding:16px; 
      border-radius:14px; font-weight:900; font-size:18px; margin:10px auto; width:90%; 
      cursor:pointer; box-shadow:0 6px 15px rgba(255,215,0,0.4);
    }
    .btn:active { transform:scale(0.96); }
    .footer { font-size:12px; color:#aaa; margin-top:20px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>สร้างโพสต์แนะนำสวย ๆ อัตโนมัติ</h2>
    <p>เหมือน Hamster Kombat!</p>
    <canvas id="banner" width="600" height="600"></canvas>
    
    <button class="btn" onclick="downloadImage()">ดาวน์โหลดรูปแชร์</button>
    <button class="btn" style="background:#0088cc;color:#fff;" onclick="shareToX()">แชร์ไป X (Twitter)</button>
    <button class="btn" style="background:#e74c3c;" onclick="Telegram.WebApp.close()">กลับ</button>
    
    <p class="footer">แชร์รูปนี้ → รับ 100,000 KUBA!</p>
  </div>

  <script>
    Telegram.WebApp.ready();
    const userId = Telegram.WebApp.initDataUnsafe?.user?.id || 'unknown';
    const refLink = `https://t.me/kubaminer_bot?start=ref_${userId}`;

    const canvas = document.getElementById('banner');
    const ctx = canvas.getContext('2d');

    // โหลดรูปตัวการ์ตูน
    const coinImg = new Image();
    coinImg.crossOrigin = "anonymous";
    coinImg.src = "https://i.ibb.co.com/0jX8s1L/kuba-coin.png"; // รูปหัวโต

    coinImg.onload = () => drawBanner();

    function drawBanner() {
      const gradient = ctx.createLinearGradient(0, 0, 600, 600);
      gradient.addColorStop(0, '#1a0033');
      gradient.addColorStop(1, '#0a0a1a');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 600, 600);

      // วงกลมทอง
      ctx.beginPath();
      ctx.arc(300, 220, 130, 0, Math.PI * 2);
      ctx.fillStyle = '#FFD700';
      ctx.shadowColor = '#FFA500';
      ctx.shadowBlur = 40;
      ctx.fill();
      ctx.shadowBlur = 0;

      // วาดรูปตัวการ์ตูน
      ctx.save();
      ctx.beginPath();
      ctx.arc(300, 220, 115, 0, Math.PI * 2);
      ctx.clip();
      ctx.drawImage(coinImg, 300-115, 220-115, 230, 230);
      ctx.restore();

      // ข้อความ
      ctx.fillStyle = '#fff';
      ctx.font = 'bold 48px "Orbitron", sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('KUBA MINER', 300, 380);

      ctx.fillStyle = '#4ade80';
      ctx.font = 'bold 56px "Orbitron", sans-serif';
      ctx.fillText('100,000 KUBA', 300, 440);

      ctx.fillStyle = '#fff';
      ctx.font = '22px "Poppins", sans-serif';
      ctx.fillText('FREE AIRDROP!', 300, 475);

      ctx.fillStyle = '#FFD700';
      ctx.font = 'bold 20px "Poppins", sans-serif';
      ctx.fillText('Tap & Earn on Polygon', 300, 505);

      // ลิงก์
      ctx.fillStyle = '#aaa';
      ctx.font = '18px monospace';
      const shortLink = refLink.length > 40 ? refLink.slice(0,37)+'...' : refLink;
      ctx.fillText(shortLink, 300, 545);

      // โลโก้เล็ก
      ctx.fillStyle = '#FFD700';
      ctx.font = '16px sans-serif';
      ctx.fillText('Powered by KUBA Miner', 300, 580);
    }

    function downloadImage() {
      const link = document.createElement('a');
      link.download = 'KUBA_Airdrop_100K.png';
      link.href = canvas.toDataURL();
      link.click();
    }

    function shareToX() {
      const text = `KUBA MINER IS LIVE! 

Tap to Earn 100,000 KUBA FREE! 

  100,000 KUBA
  Daily Rewards
  Real Polygon Token

${refLink}

#KUBA #Airdrop #Crypto #TapToEarn`;
      const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Poppins:wght@600;800&display=swap" rel="stylesheet">
</body>
</html>